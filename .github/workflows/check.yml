name: Check & Test Jupyter Notebook execution

on:
  push:
    branches: 
      - main
      - faris_add_codetest
  
  pull_request:
    types: [synchronize, review_requested]

jobs:
  check_solution:
    name: Test Solution folder
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo into GitHub's runner
        uses: actions/checkout@v2

        # Setup mini-conda environment
      - name: Setup Conda 
        uses: conda-incubator/setup-miniconda@v2
        with:
          #activate-environment: basics-of-data-analytics
          #environment-file: "environment.yml"
          auto-activate-base: false

        # Install dependencies into conda env / Set globstar on to allow "**" pattern in bash
      - name: Install required dependencies 
        shell: bash -l {0}
        run: | 
          conda search -c conda-forge m2w64-gcc-libgfortran
          pip install treon
          shopt -s globstar
      
      - name: Execute Treon 
        shell: bash -l {0}
        run: |
          for i in **/{S,s}olution/**; do 
            treon "$i" 
          done

  check_exercise:
    name: Test Exercise folder
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo into GitHub's runner
        uses: actions/checkout@v2

        # Setup mini-conda environment
      - name: Setup Conda 
        uses: conda-incubator/setup-miniconda@v2
        with:
          #activate-environment: basics-of-data-analytics
          #environment-file: "environment.yml"
          auto-activate-base: false

        # Install dependencies into conda env / Set globstar on to allow "**" pattern in bash
      - name: Install required dependencies 
        shell: bash -l {0}
        run: |
          conda search -c conda-forge m2w64-gcc-libgfortran
          pip install treon
          shopt -s globstar
      
      - name: Execute Treon 
        shell: bash -l {0}
        run: |
          for i in **/{E,e}xercise/**; do 
            treon "$i" || continue
          done



    
